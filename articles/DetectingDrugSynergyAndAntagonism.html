<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PharmacoGx">
<title>Detecting Drug Synergy and Antagonism with PharmacoGx 3.0+ • PharmacoGx</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detecting Drug Synergy and Antagonism with PharmacoGx 3.0+">
<meta property="og:description" content="PharmacoGx">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PharmacoGx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.3.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/PharmacoGx.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/CreatingPharmacoSet.html">PharmacoGx: An R Package for Analysis of Large Pharmacogenomic Datasets</a>
    <a class="dropdown-item" href="../articles/DetectingDrugSynergyAndAntagonism.html">Detecting Drug Synergy and Antagonism with PharmacoGx 3.0+</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bhklab/PharmacoGx/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Detecting Drug Synergy and Antagonism with PharmacoGx 3.0+</h1>
                        <h4 data-toc-skip class="author">Christopher
Eeles</h4>
            <address class="author_afil">
      Princess Margaret Cancer Centre, University Health Network,
Toronto Canada<br><a class="author_email" href="mailto:#"></a><a href="mailto:christopher.eeles@uhnresearch.ca" class="email">christopher.eeles@uhnresearch.ca</a>
      </address>
                              <h4 data-toc-skip class="author">Feifei
Li</h4>
            <address class="author_afil">
      Department of Cell &amp; System Biology, University of Toronto,
Toronto
Canada<br><h4 data-toc-skip class="author">Petr
Smirnov</h4>
            <address class="author_afil">
      Princess Margaret Cancer Centre, University Health Network,
Toronto CanadaDepartment of Medical Biophysics, University of Toronto,
Toronto Canada<br><a class="author_email" href="mailto:#"></a><a href="mailto:psmirnov@utoronto.ca" class="email">psmirnov@utoronto.ca</a>
      </address>
                              <h4 data-toc-skip class="author">Benjamin
Haibe-Kains</h4>
            <address class="author_afil">
      Princess Margaret Cancer Centre, University Health Network,
Toronto CanadaDepartment of Medical Biophysics, University of Toronto,
Toronto Canada<br><a class="author_email" href="mailto:#"></a><a href="mailto:benjamin.haibe.kains@utoronto.ca" class="email">benjamin.haibe.kains@utoronto.ca</a>
      </address>
                  
      
      <small class="dont-index">Source: <a href="https://github.com/bhklab/PharmacoGx/blob/HEAD/vignettes/DetectingDrugSynergyAndAntagonism.Rmd" class="external-link"><code>vignettes/DetectingDrugSynergyAndAntagonism.Rmd</code></a></small>
      <div class="d-none name"><code>DetectingDrugSynergyAndAntagonism.Rmd</code></div>
    </address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Drug combinations are an effective strategy to overcome
      incomplete response or acquired resistance to monotherapies in
      clinical oncology and beyond. As such, detecting molecular
      signatures of drug synergy or antagonism in pre-clinical model
      systems is a major priority to accelerate the adoption of novel
      treatment strategies in the clinic. The release of PharmacoGx 3.0
      introduces support for storing, analyzing and visualizing the
      results of drug combination experiments using the PharmacoSet
      class, and will enable reseachers across a range of disciplines to
      more easily mine t he published drug combination literature for
      promising molecular signatures of synergy or antagonism which can
      be validated in retrospective patient data and prioritized for
      prospective clinical trails.</p>
    </div>
    
<div class="section level2">
<h2 id="synergyantagonism-biomarker-discovery">Synergy/Antagonism Biomarker Discovery<a class="anchor" aria-label="anchor" href="#synergyantagonism-biomarker-discovery"></a>
</h2>
<p>For a comprehensive introduction to detecting biomarkers of drug
synergy or antagonism with <em><a href="https://bioconductor.org/packages/3.16/CoreGx" class="external-link">CoreGx</a></em> and
<em><a href="https://bioconductor.org/packages/3.16/PharmacoGx" class="external-link">PharmacoGx</a></em>,
please see our <a href="http://bhklab.ca/bioc2022workshop/articles/PGxWorkshop.html" class="external-link">workshop
from BioC2022</a>.</p>
</div>
<div class="section level2">
<h2 id="mathews-griner">Mathews Griner<a class="anchor" aria-label="anchor" href="#mathews-griner"></a>
</h2>
<p>The Mathews Griner dataset was generated in a high-throughput drug
combination screening study conducted to explore potential drug
synergies and antagonisms in a panel of 459 compounds combined with the
Tyrosine Kinase inhibitor ibrutinib in cancer cell lines from the
activated B-cell like subtype of diffuse large B-cell lymphoma <span class="citation">(Mathews Griner et al. 2014)</span>. The study uses a 6
x 6 combination matrix design, where each respective drug in a
combination undergoes a 4-fold dilution series over 4 steps, with the
last well left untreated. This can be conceptualized as a drug
combination matrix where the last row and column represent monotherapy
experiments for each compound in the pair. A total of 36 viability
measurements were taken via the CellTitreGlo assay for each drug pair,
being comprised of pair-wise combinations of each dose level in the
respective dilution series matrix.</p>
<p>We selected this dataset for our vignette to simplify comparison with
the <code>SynergyFinder</code> package, which was previously used to
analyze this dataset <span class="citation">(Yadav et al.
2015)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PharmacoGx</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CoreGx</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="reading-in-raw-data">Reading in Raw Data<a class="anchor" aria-label="anchor" href="#reading-in-raw-data"></a>
</h3>
<p>We have included a compressed CSV version of the Mathews Griner
dataset which we curated to have informative compound names. You can
read the file in with your CSV reader of choice.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/mathews_griner.csv.tar.gz"</span>,</span>
<span>    package<span class="op">=</span><span class="st">"PharmacoGx"</span><span class="op">)</span></span>
<span><span class="va">mathews_griner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">input_file</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="experimental-design-hypothesis">Experimental Design Hypothesis<a class="anchor" aria-label="anchor" href="#experimental-design-hypothesis"></a>
</h3>
<p>Before modelling dose-response or treatment synergy/antagonism with
<em><a href="https://bioconductor.org/packages/3.16/PharmacoGx" class="external-link">PharmacoGx</a></em>
we must first build a <code>TreatmentResponseExperiment</code> from our
high-throughput drug combination data. This S4 class was designed to
store and analyze high dimensional treatment response data, such as the
dose-response screens in cancer cell lines which are the subject of this
analysis. For a detailed explanation of the class design, please refer
to the <a href="http://bhklab.ca/CoreGx/articles/TreatmentResponseExperiment.html" class="external-link">TreatmentResponseExperiment
vignette in CoreGx</a>.</p>
<p>Due to the highly diverse set of experimental designs used in drug
combination studies, the first step in any drug combination analysis is
to generate a hypothesis about the study design. For the
<code>TreatmentResponseExperiment</code>, we must identify which columns
in our raw data are required to uniquely identify every treatment (our
rows), sample (our columns) and observation (our assays). As a starting
point we recommend trying treatment identifiers and their respective
doses for rows, sample identifiers for columns, and the union of these
for observations.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Giving names to columns in your group list will
automatically rename them when the
&lt;code&gt;TreatmentResponseExperiment&lt;/code&gt; gets created!&lt;/p&gt;"><sup>1</sup></a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    rowDataMap<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        treatment1id<span class="op">=</span><span class="st">"RowName"</span>, treatment2id<span class="op">=</span><span class="st">"ColName"</span>,</span>
<span>        treatment1dose<span class="op">=</span><span class="st">"RowConcs"</span>, treatment2dose<span class="op">=</span><span class="st">"ColConcs"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    colDataMap<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sampleid"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">groups</span><span class="op">[[</span><span class="st">"assayMap"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">groups</span><span class="op">$</span><span class="va">rowDataMap</span>, <span class="va">groups</span><span class="op">$</span><span class="va">colDataMap</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">groups</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $rowDataMap</span></span>
<span><span class="co">##   treatment1id   treatment2id treatment1dose treatment2dose </span></span>
<span><span class="co">##      "RowName"      "ColName"     "RowConcs"     "ColConcs" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colDataMap</span></span>
<span><span class="co">## [1] "sampleid"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $assayMap</span></span>
<span><span class="co">##   treatment1id   treatment2id treatment1dose treatment2dose                </span></span>
<span><span class="co">##      "RowName"      "ColName"     "RowConcs"     "ColConcs"     "sampleid"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="handling-undocumented-replicates">Handling Undocumented Replicates<a class="anchor" aria-label="anchor" href="#handling-undocumented-replicates"></a>
</h3>
<p>These initial guesses can be insufficient to uniquely identify our
treatments or samples if there are technical or biological replicates in
the data. While some publications are explicit about the presence of
such measurements, others are not and require us to explore the data to
identify them. In general, we recommend undocumented replicates be
treated as technical and used to quantify noise in the assay unless
there is a good reason to believe they are from distinct biological
entities.</p>
<p>We can identify undocumented replicates using a “group by” operation.
This operation uses the split-apply-combine strategy (also called
Map-Reduce) to compute some aggregation over subsets of a
<code>data.frame</code>. A grouping has undocumented replicates if more
than one row is assigned to any group which we hypothesized to uniquely
identify the observations in our data. We check this below using the
<code>.N</code> special variable from the <em><a href="https://CRAN.R-project.org/package=data.table" class="external-link">data.table</a></em>
package, which counts the number of instances in each group defined by
the columns in <code>by</code>. This operation could also be
accomplished with <code>dplyr</code> or even base R, though they may be
slower and have less concise syntax.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The := operator modifies a data.table by reference (i.e., without making a copy)</span></span>
<span><span class="va">mathews_griner</span><span class="op">[</span>, <span class="va">tech_rep</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">.N</span><span class="op">)</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">groups</span><span class="op">[[</span><span class="st">"assayMap"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mathews_griner</span><span class="op">[[</span><span class="st">"tech_rep"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">groups</span><span class="op">[[</span><span class="st">"colDataMap"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">groups</span><span class="op">[[</span><span class="st">"colDataMap"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"tech_rep"</span><span class="op">)</span></span>
<span>    <span class="va">groups</span><span class="op">[[</span><span class="st">"assayMap"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">groups</span><span class="op">[[</span><span class="st">"assayMap"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"tech_rep"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># delete the additional column if not needed</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"No technical replicates in this dataset!"</span><span class="op">)</span></span>
<span>    <span class="va">mathews_griner</span><span class="op">[[</span><span class="st">"tech_reps"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For the Mathews Griner dataset, we do indeed have undocumented
replicates! These will be treated a technical replicates.</p>
</div>
<div class="section level3">
<h3 id="using-the-tredatamapper">Using the <code>TREDataMapper</code><a class="anchor" aria-label="anchor" href="#using-the-tredatamapper"></a>
</h3>
<p>Once we are confident we know which columns are needed to uniquely
identify our treatments and samples, we can create a
<code>TREDataMapper</code> using our raw data and mapping hypothesis.
The <code>TREDataMapper</code> is a helper class designed to make
creating a <code>TreatmentResponseExperiment</code> from diverse drug
combination experimental designs easier for users.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See the &lt;code&gt;TreatmentResponseExperiment&lt;/code&gt;
vignette in &lt;em&gt;&lt;a href="https://bioconductor.org/packages/3.16/CoreGx" class="external-link"&gt;CoreGx&lt;/a&gt;&lt;/em&gt; to
learn more about the &lt;code&gt;TREDataMapper&lt;/code&gt; class.&lt;/p&gt;'><sup>2</sup></a></p>
<p>The <code>guessMapping</code> method does the necessary internal work
to map additional columns in your dataset to the appopriate
category—treatment metadata, sample metadata or assay data—and returns
the column names for each group in the “mapped_columns” list item.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">treMapper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/TREDataMapper.html" class="external-link">TREDataMapper</a></span><span class="op">(</span>rawdata<span class="op">=</span><span class="va">mathews_griner</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [33m [1m [3m&lt;TREDataMapper&gt; 
##  [23m [22m [39m [33m [1mrawdata: [22m [39m dim(16776, 21)
##      BlockId   Col   Row viability AssayId  Size          RowSid      RowName
##        &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;num&gt;   &lt;int&gt; &lt;int&gt;          &lt;char&gt;       &lt;char&gt;
##   1:       1     1     1  14.47499     241     6 NCGC00181170-01 Bendamustine
##   2:       1     2     1  28.67605     241     6 NCGC00181170-01 Bendamustine
##   3:       1     3     1  48.73285     241     6 NCGC00181170-01 Bendamustine
##   13 variables not shown: [RowTarget &lt;char&gt;, ColSid &lt;char&gt;, ColName
##     &lt;char&gt;, ColTarget &lt;char&gt;, RowIC50 &lt;int&gt;, ColIC50 &lt;int&gt;, RowConcs
##     &lt;num&gt;, ColConcs &lt;num&gt;, RowConcUnit &lt;char&gt;, ColConcUnit &lt;char&gt;, ...] 
## 
 [33m [1mrowDataMap: [22m [39m
##    [32mrowIDs: [39m 
##    [32mrowMeta: [39m 
##  [33m [1mcolDataMap: [22m [39m
##    [32mcolIDs: [39m 
##    [32mcolMeta: [39m  [33m [1m
## assayMap: [22m [39m [33m [1m
## metadataMap: [22m [39m [32m NA [39m</code></pre>
<p>We will know we have successfully mapped all of our data if the
“unmapped” list item in our guess has no column names in it. If this is
not the case, you may have to refine your hypothesis to include
additional information needed to uniquely identify each observation in
your dataset.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The metadata item in the list returned from
&lt;code&gt;guessMapping&lt;/code&gt; captures all columns in our dataset which only
have one unique value. These will be assigned to the
&lt;code&gt;metadata&lt;/code&gt; slot of the
&lt;code&gt;TreatmentResponseExperiment&lt;/code&gt; to save memory.&lt;/p&gt;"><sup>3</sup></a></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">guess</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/guessMapping.html" class="external-link">guessMapping</a></span><span class="op">(</span><span class="va">treMapper</span>, <span class="va">groups</span>, subset<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [CoreGx::guessMapping,LongTableDataMapper-method]</span></span>
<span><span class="co">##  Mapping for group rowDataMap: RowName, ColName, RowConcs, ColConcs</span></span></code></pre>
<pre><code><span><span class="co">## [CoreGx::guessMapping,LongTableDataMapper-method]</span></span>
<span><span class="co">##  Mapping for group colDataMap: sampleid, tech_rep</span></span></code></pre>
<pre><code><span><span class="co">## [CoreGx::guessMapping,LongTableDataMapper-method]</span></span>
<span><span class="co">##  Mapping for group assayMap: RowName, ColName, RowConcs, ColConcs, sampleid, tech_rep</span></span></code></pre>
<pre><code><span><span class="co">## $metadata</span></span>
<span><span class="co">## $metadata$id_columns</span></span>
<span><span class="co">## [1] NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $metadata$mapped_columns</span></span>
<span><span class="co">## [1] "AssayId"     "Size"        "ColSid"      "ColTarget"   "RowIC50"    </span></span>
<span><span class="co">## [6] "ColIC50"     "RowConcUnit" "ColConcUnit" "tissueid"   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowDataMap</span></span>
<span><span class="co">## $rowDataMap$id_columns</span></span>
<span><span class="co">##   treatment1id   treatment2id treatment1dose treatment2dose </span></span>
<span><span class="co">##      "RowName"      "ColName"     "RowConcs"     "ColConcs" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowDataMap$mapped_columns</span></span>
<span><span class="co">## [1] "Col"       "Row"       "RowTarget"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colDataMap</span></span>
<span><span class="co">## $colDataMap$id_columns</span></span>
<span><span class="co">## [1] "sampleid" "tech_rep"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colDataMap$mapped_columns</span></span>
<span><span class="co">## character(0)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $assayMap</span></span>
<span><span class="co">## $assayMap$id_columns</span></span>
<span><span class="co">##   treatment1id   treatment2id treatment1dose treatment2dose                </span></span>
<span><span class="co">##      "RowName"      "ColName"     "RowConcs"     "ColConcs"     "sampleid" </span></span>
<span><span class="co">##                </span></span>
<span><span class="co">##     "tech_rep" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $assayMap$mapped_columns</span></span>
<span><span class="co">## [1] "BlockId"   "viability" "RowSid"   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $unmapped</span></span>
<span><span class="co">## character(0)</span></span></code></pre>
<p>Once we have mapped all our columns, we can assign their names to the
<code>TREDataMapper</code> object and use it to construct the
<code>TreatmentResponseExperiment</code> we will use in downstream
dose-response and synergy-antagonism modelling.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;We need to give names to the &lt;code&gt;metadataMap&lt;/code&gt;
and &lt;code&gt;assayMap&lt;/code&gt; in the &lt;code&gt;TREDataMapper&lt;/code&gt;, since there
can be more than one item in each of these slots of a
&lt;code&gt;TreatmentResponseExperiment&lt;/code&gt;.&lt;/p&gt;"><sup>4</sup></a></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/TREDataMapper-accessors.html" class="external-link">metadataMap</a></span><span class="op">(</span><span class="va">treMapper</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>experiment_metadata<span class="op">=</span><span class="va">guess</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">mapped_columns</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/TREDataMapper-accessors.html" class="external-link">rowDataMap</a></span><span class="op">(</span><span class="va">treMapper</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">guess</span><span class="op">$</span><span class="va">rowDataMap</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/TREDataMapper-accessors.html" class="external-link">colDataMap</a></span><span class="op">(</span><span class="va">treMapper</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">guess</span><span class="op">$</span><span class="va">colDataMap</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/TREDataMapper-accessors.html" class="external-link">assayMap</a></span><span class="op">(</span><span class="va">treMapper</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>raw<span class="op">=</span><span class="va">guess</span><span class="op">$</span><span class="va">assayMap</span><span class="op">)</span></span>
<span><span class="va">treMapper</span></span></code></pre></div>
<pre><code>##  [33m [1m [3m&lt;TREDataMapper&gt; 
##  [23m [22m [39m [33m [1mrawdata: [22m [39m dim(16776, 21)
##      BlockId   Col   Row viability AssayId  Size          RowSid      RowName
##        &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;num&gt;   &lt;int&gt; &lt;int&gt;          &lt;char&gt;       &lt;char&gt;
##   1:       1     1     1  14.47499     241     6 NCGC00181170-01 Bendamustine
##   2:       1     2     1  28.67605     241     6 NCGC00181170-01 Bendamustine
##   3:       1     3     1  48.73285     241     6 NCGC00181170-01 Bendamustine
##   13 variables not shown: [RowTarget &lt;char&gt;, ColSid &lt;char&gt;, ColName
##     &lt;char&gt;, ColTarget &lt;char&gt;, RowIC50 &lt;int&gt;, ColIC50 &lt;int&gt;, RowConcs
##     &lt;num&gt;, ColConcs &lt;num&gt;, RowConcUnit &lt;char&gt;, ColConcUnit &lt;char&gt;, ...] 
## 
 [33m [1mrowDataMap: [22m [39m
##    [32mrowIDs: [39m RowName, ColName, RowConcs, ColConcs
##    [32mrowMeta: [39m Col, Row, RowTarget
##  [33m [1mcolDataMap: [22m [39m
##    [32mcolIDs: [39m sampleid, tech_rep
##    [32mcolMeta: [39m  [33m [1m
## assayMap: [22m [39m
##    [31mraw: [39m
##     keys: RowName, ColName, RowConcs, ColConcs, sampleid, tech_rep
##     values: BlockId, viability, RowSid [33m [1m
## metadataMap: [22m [39m
##    [32mexperiment_metadata: [39m AssayId, Size, ColSid, ColTarget, RowIC50, ColIC50, RowConcUnit, ColConcUnit, tissueid</code></pre>
</div>
<div class="section level3">
<h3 id="creating-a-treatmentresponseexperiment">Creating a <code>TreatmentResponseExperiment</code><a class="anchor" aria-label="anchor" href="#creating-a-treatmentresponseexperiment"></a>
</h3>
<p><em><a href="https://bioconductor.org/packages/3.16/PharmacoGx" class="external-link">PharmacoGx</a></em>
includes the <code>metaConstruct</code> method to simplify creation of a
<code>TreatmentResponseExperiment</code> object. Simply call it on the
<code>TREDataMapper</code> you created previously to instantiate the
object.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">tre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/metaConstruct.html" class="external-link">metaConstruct</a></span><span class="op">(</span><span class="va">treMapper</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold; font-style: italic;">&lt;TreatmentResponseExperiment&gt; </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold; font-style: italic;">## </span><span style="color: #BBBB00; font-weight: bold;">dim:  16668 2 </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold;">## assays(1): </span><span style="color: #BB0000;">raw</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">rownames(16668): </span><span style="color: #00BB00;">(-)-Gossypol:Ibrutinib (PCI-32765):0:0 (-)-Gossypol:Ibrutinib (PCI-32765):0:0.1954 ... methyl jasmonate:Ibrutinib (PCI-32765):2500:12.5 methyl jasmonate:Ibrutinib (PCI-32765):2500:50</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">rowData(7): </span><span style="color: #00BB00;">treatment1id treatment2id treatment1dose ... Col Row RowTarget</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">colnames(2): </span><span style="color: #00BB00;">TMD8:1 TMD8:2</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">colData(2): </span><span style="color: #00BB00;">sampleid tech_rep</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">metadata(1): </span><span style="color: #00BB00;">experiment_metadata</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="normalizing-treatment-response">Normalizing Treatment Response<a class="anchor" aria-label="anchor" href="#normalizing-treatment-response"></a>
</h3>
<p>The viability measurements in the Mathews Griner data have already
been normalized relative to the time zero control. However, <em><a href="https://bioconductor.org/packages/3.16/PharmacoGx" class="external-link">PharmacoGx</a></em>
recommends further normalizing against the untreated control to limit
the range of your viability measurements to be close to [0, 1]. The
untreated control is the well which has only been treated with the drug
delivery vehicle (usually the solvent DMSO) and has thus been allowed to
grow over the treatment exposure time.</p>
<p>To accomplish this for our current dataset, we can use a sub-query
where we select the viability at index (6, 6) of our drug combination
matrix. This well has not been treated with either drug. Dividing by it
normalizes the observed viability in our treatment wells relative to any
growth that may have occured during treatment. We further truncate our
viability values at zero, since any values below this are likely a
result of technical noise in our assay.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The &lt;code&gt;.SD&lt;/code&gt; special variable, short for “subset
data”, is a &lt;em&gt;&lt;a href="https://CRAN.R-project.org/package=data.table" class="external-link"&gt;data.table&lt;/a&gt;&lt;/em&gt;
feature that allows you to implement complex sub-queries. It contains a
reference to the table being queried.&lt;/p&gt;'><sup>5</sup></a></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw</span> <span class="op">&lt;-</span> <span class="va">tre</span><span class="op">[[</span><span class="st">"raw"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">raw</span><span class="op">[</span>,</span>
<span>    <span class="va">viability</span> <span class="op">:=</span> <span class="va">viability</span> <span class="op">/</span> <span class="va">.SD</span><span class="op">[</span><span class="va">treatment1dose</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">treatment2dose</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">viability</span><span class="op">]</span>,</span>
<span>    by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"treatment2id"</span>, <span class="st">"sampleid"</span>, <span class="st">"tech_rep"</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span><span class="va">raw</span><span class="op">[</span>, <span class="va">viability</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">viability</span><span class="op">)</span><span class="op">]</span>  <span class="co"># truncate min viability at 0</span></span>
<span><span class="va">tre</span><span class="op">[[</span><span class="st">"raw"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">raw</span></span></code></pre></div>
<p>As a sanity check that our normalization was effective, we will look
at the range of our viabiltiy values. In most cases, this should be very
close to [0, 1], since we do not expect treatment with one or more
compound to increase the growth of our cell lines relative to the
untreated control.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre</span><span class="op">[[</span><span class="st">"raw"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">viability</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  0.00000 60.96139</span></span></code></pre>
<p>Some of our treated viabilties are &gt;60x higher than our control!
This is very unlikely to be a real signal and probably indicates there
was an issue with the viability measurement for our dose 0 x 0 well. To
quality control our results, we will find the treatment combination with
this observation and remove it from downstream analysis. It is essential
to perform regular sanity checks to ensure your data is plausible given
the experimental setup.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">bad_treatments</span> <span class="op">&lt;-</span> <span class="va">tre</span><span class="op">[[</span><span class="st">"raw"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">viability</span> <span class="op">&gt;</span> <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">treatment1id</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "IKK-16"</span></span></code></pre>
<p>Only a single treatment has a viability measurement higher than twice
our control. We will remove this and leave the remaining values in
place, since we can simply truncate them at viability of 1 to include as
many combinations in our analyses as possible.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">tre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">tre</span>, <span class="op">!</span><span class="op">(</span><span class="va">treatment1id</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">bad_treatments</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold; font-style: italic;">&lt;TreatmentResponseExperiment&gt; </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold; font-style: italic;">## </span><span style="color: #BBBB00; font-weight: bold;">dim:  16632 2 </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold;">## assays(1): </span><span style="color: #BB0000;">raw</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">rownames(16632): </span><span style="color: #00BB00;">(-)-Gossypol:Ibrutinib (PCI-32765):0:0 (-)-Gossypol:Ibrutinib (PCI-32765):0:0.1954 ... methyl jasmonate:Ibrutinib (PCI-32765):2500:12.5 methyl jasmonate:Ibrutinib (PCI-32765):2500:50</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">rowData(7): </span><span style="color: #00BB00;">treatment1id treatment2id treatment1dose ... Col Row RowTarget</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">colnames(2): </span><span style="color: #00BB00;">TMD8:1 TMD8:2</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">colData(2): </span><span style="color: #00BB00;">sampleid tech_rep</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">metadata(1): </span><span style="color: #00BB00;">experiment_metadata</span></span></span></code></pre>
<p>We will inspect the viability range again to ensure the bad data has
been removed.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre</span><span class="op">[[</span><span class="st">"raw"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">viability</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.000000 1.858926</span></span></code></pre>
<p>The range for viabilities is now much more reasonable, and we can
move on to fitting dose-response curves to our monotherapy
measurements.</p>
</div>
<div class="section level3">
<h3 id="fitting-monotherapy-curves">Fitting Monotherapy Curves<a class="anchor" aria-label="anchor" href="#fitting-monotherapy-curves"></a>
</h3>
<p>The <code>endoaggregate</code> method allows us to extract an assay
from our <code>TreatmentResponseExperiment</code>, compute a group by
(aggregation) over it, then assign it back to our
<code>TreatmentResponseExperiment</code> via a join, all in a single
function call. Since we currently only want to fit curves to the
monotherapy experiments in our drug matrix we will use the
<code>subset</code> argument to filter the assay to only monotherapy
rows before applying the aggregation.</p>
<p>This method is useful to update existing assays, or to create new
ones. The <code>assay</code> argument specifies the assay to aggregate
over and the <code>target</code> argument specifies the name of the
assay to assign the results to. If the <code>target</code> does not
already exist, a new assay will be created otherwise the specified
<code>target</code> will be updated. If you exclude this argument, the
<code>assay</code> you select automatically becomes the
<code>target</code>. The <code>endoaggregate</code> method is
endomorphic, a class of methods that always return the same type they
are called on. This means that <code>endoaggregate</code> always returns
a new <code>TreatmentResponseExperiment</code>.</p>
<p>While subsetting out our monotherapy viabilities, we can also
summarize viabilities over our techinical replicates by excluding that
column from our <code>by</code> argument. Any additional arguments to
<code>endoaggregate</code> via <code>...</code> are assumed to be
aggregation calls and will be computed for each group identified in
<code>by</code> and assigned to <code>target</code>. The name given to
any argument in <code>...</code> will be the column name for that
computation in the resulting
<code>TreatmentResponseExperiment</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre_qc</span> <span class="op">&lt;-</span> <span class="va">tre</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        subset<span class="op">=</span><span class="va">treatment2dose</span> <span class="op">==</span> <span class="fl">0</span>,  <span class="co"># filter to only monotherapy rows</span></span>
<span>        assay<span class="op">=</span><span class="st">"raw"</span>,</span>
<span>        target<span class="op">=</span><span class="st">"mono_viability"</span>,  <span class="co"># create a new assay named mono_viability</span></span>
<span>        mean_viability<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">viability</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"treatment1dose"</span>, <span class="st">"sampleid"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Once we have isolated our monotherapy viabilities, we can once again
use <code>endoaggregate</code> to fit our dose-response curves. This
time we will use the <code>enlist=FALSE</code> option which allows us to
assign intermediate variables during our aggregation. Pass in an entire
code block to <code>endoggregate</code> to use this feature and only the
returned list will be assigned to the <code>target</code> assay, with
each list item as a column with the corresponding name. To prevent
repeating our curve fit parameters, we will create a new assay for them
since we are now summarizing over dose. This helps ensure we use only as
much memory as is necessary to store the analysis results in our
<code>TreatmentResponseExperiment</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre_fit</span> <span class="op">&lt;-</span> <span class="va">tre_qc</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        <span class="op">{</span>  <span class="co"># the entire code block is evaluated for each group in our group by</span></span>
<span>            <span class="co"># 1. fit a log logistic curve over the dose range</span></span>
<span>            <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">PharmacoGx</span><span class="fu">::</span><span class="fu"><a href="../reference/logLogisticRegression.html">logLogisticRegression</a></span><span class="op">(</span><span class="va">treatment1dose</span>, <span class="va">mean_viability</span>,</span>
<span>                viability_as_pct<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>            <span class="co"># 2. compute curve summary metrics</span></span>
<span>            <span class="va">ic50</span> <span class="op">&lt;-</span> <span class="fu">PharmacoGx</span><span class="fu">::</span><span class="fu"><a href="../reference/computeICn.html">computeIC50</a></span><span class="op">(</span><span class="va">treatment1dose</span>, Hill_fit<span class="op">=</span><span class="va">fit</span><span class="op">)</span></span>
<span>            <span class="va">aac</span> <span class="op">&lt;-</span> <span class="fu">PharmacoGx</span><span class="fu">::</span><span class="fu"><a href="../reference/computeAUC.html">computeAUC</a></span><span class="op">(</span><span class="va">treatment1dose</span>, Hill_fit<span class="op">=</span><span class="va">fit</span><span class="op">)</span></span>
<span>            <span class="co"># 3. assemble the results into a list, each item will become a</span></span>
<span>            <span class="co">#   column in the target assay.</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                HS<span class="op">=</span><span class="va">fit</span><span class="op">[[</span><span class="st">"HS"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                E_inf <span class="op">=</span> <span class="va">fit</span><span class="op">[[</span><span class="st">"E_inf"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                EC50 <span class="op">=</span> <span class="va">fit</span><span class="op">[[</span><span class="st">"EC50"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                Rsq<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                aac_recomputed<span class="op">=</span><span class="va">aac</span>,</span>
<span>                ic50_recomputed<span class="op">=</span><span class="va">ic50</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>        assay<span class="op">=</span><span class="st">"mono_viability"</span>,</span>
<span>        target<span class="op">=</span><span class="st">"mono_profiles"</span>,</span>
<span>        enlist<span class="op">=</span><span class="cn">FALSE</span>,  <span class="co"># this option enables the use of a code block for aggregation</span></span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"sampleid"</span><span class="op">)</span>,</span>
<span>        nthread<span class="op">=</span><span class="fl">2</span>  <span class="co"># parallelize over multiple cores to speed up the computation</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="joining-monotherapy-curve-fits-to-combinations">Joining Monotherapy Curve Fits to Combinations<a class="anchor" aria-label="anchor" href="#joining-monotherapy-curve-fits-to-combinations"></a>
</h3>
<p>Since we require the monotherapy curve parameters to calculate
dose-response curve dependent synergy metrics such as Loewe and ZIP, we
will add these to a new drug combination assay to make computing synergy
metrics possible within a single <code>endoaggregate</code> call.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;If we don’t name an aggregation in
&lt;code&gt;endoaggregate&lt;/code&gt; a default name will be inferred from the
function name and its first argument. In this case, the column will be
called “mean_viability”.&lt;/p&gt;"><sup>6</sup></a></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre_combo</span> <span class="op">&lt;-</span> <span class="va">tre_fit</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        assay<span class="op">=</span><span class="st">"raw"</span>,</span>
<span>        target<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">viability</span><span class="op">)</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"treatment2id"</span>, <span class="st">"treatment1dose"</span>, <span class="st">"treatment2dose"</span>,</span>
<span>            <span class="st">"sampleid"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>The <code>mergeAssays</code> method is a convenient way to perform
joins between the assays of a <code>TreatmentResponseExperiment</code>
endomorphically. It is equivalent to extracting the assays from the
object, performing a join using the <code>merge</code> command, and
assigning back to the assay specified as the <code>x</code> argument.
This method accepts all the same parameters as the
<code><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">data.table::merge</a></code> function, but requires the assays in
<code>x</code> and <code>y</code> be specified as assay names instead of
actual assay tables.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The endomorphic nature of this operation allows the
result to be piped into additional calls, as demonstrated below.&lt;/p&gt;"><sup>7</sup></a></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre_combo</span> <span class="op">&lt;-</span> <span class="va">tre_combo</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/mergeAssays.html" class="external-link">mergeAssays</a></span><span class="op">(</span></span>
<span>        x<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        y<span class="op">=</span><span class="st">"mono_profiles"</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"sampleid"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/mergeAssays.html" class="external-link">mergeAssays</a></span><span class="op">(</span></span>
<span>        x<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        y<span class="op">=</span><span class="st">"mono_profiles"</span>,</span>
<span>        by.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment2id"</span>, <span class="st">"sampleid"</span><span class="op">)</span>,</span>
<span>        by.y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"sampleid"</span><span class="op">)</span>,</span>
<span>        suffixes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_1"</span>, <span class="st">"_2"</span><span class="op">)</span>  <span class="co"># add sufixes to duplicate column names</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>The <code>endoaggregate</code> method is compatible with standard
<code>data.table</code> syntax, since <code>assays</code> are
implemented internally using this package. As such, we can use a
sub-query (via <code>.SD</code>) to pull out the viability measurements
for each individual drug in our combination. This value is needed to
compute the Highest Single Agent and Bliss synergy metrics. We will add
these values to our “combo_viability” assay so all the synergy metrics
can be calculated in a single step.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The &lt;code&gt;endoaggregate&lt;/code&gt; method can also be used
to apply arbitrary functions to the data in an assay. Just specify the
entire assay key to the by argument to compute the function for every
row (&lt;em&gt;i.e.&lt;/em&gt;, to perform no aggregation or summary of the data).&lt;/p&gt;"><sup>8</sup></a></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre_combo</span> <span class="op">&lt;-</span> <span class="va">tre_combo</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        viability_1<span class="op">=</span><span class="va">.SD</span><span class="op">[</span><span class="va">treatment2dose</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">mean_viability</span><span class="op">]</span>,</span>
<span>        assay<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"treatment1dose"</span>, <span class="st">"sampleid"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        viability_2<span class="op">=</span><span class="va">.SD</span><span class="op">[</span><span class="va">treatment1dose</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">mean_viability</span><span class="op">]</span>,</span>
<span>        assay<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"treatment2dose"</span>, <span class="st">"sampleid"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Now that we have assembled all the requisite information into the
“combo_viability” assay, we are ready to compute our synergy scores!</p>
</div>
<div class="section level3">
<h3 id="compute-synergy-scores">Compute Synergy Scores<a class="anchor" aria-label="anchor" href="#compute-synergy-scores"></a>
</h3>
<p>Drug synergy or antagonism is detected as the deviation in the
observerd treatment response above or below the expected response.
Determining the expected response, however, is non-trivial and several
different reference models have been proposed in the literature for the
expected response to a drug combination. <em><a href="https://bioconductor.org/packages/3.16/PharmacoGx" class="external-link">PharmacoGx</a></em>
has implemented functions to calculate the expected response under the
Highest Single Agent (HSA), Loewe Additivity, Zero Interaction Potency
(ZIP) and Bliss independence null models of drug synergy.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The formula for each of these models is different when
using proportion of response vs proportion of viability. In &lt;em&gt;&lt;a href="https://bioconductor.org/packages/3.16/PharmacoGx" class="external-link"&gt;PharmacoGx&lt;/a&gt;&lt;/em&gt;
all synergy computations assume we are working with proportion
viability. If you instead have response values you can convert them to
viabilities by subtracting the normalized responses from 1 (or 100 if
using percentages).&lt;/p&gt;'><sup>9</sup></a></p>
<p>These models are discussed in more detail in our workshop from the
2022 Bioconductor conference, linked at the top of this vignette.
Addition resources to learn about drug synergy models include <span class="citation">(Yadav et al. 2015)</span> for mathematical definitions
of each reference model and <span class="citation">(Vlot et al.
2019)</span> for exploring the assumptions of each model and how they
can affect resulting drug synergy predicitons.</p>
<p>Below we use PharmacoGx to compute the expected response under all
four null reference models of drug synergy.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre_synergy</span> <span class="op">&lt;-</span> <span class="va">tre_combo</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        assay<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        HSA_ref<span class="op">=</span><span class="fu">PharmacoGx</span><span class="fu">::</span><span class="fu"><a href="../reference/computeHSA.html">computeHSA</a></span><span class="op">(</span><span class="va">viability_1</span>, <span class="va">viability_2</span><span class="op">)</span>,</span>
<span>        Bliss_ref<span class="op">=</span><span class="fu">PharmacoGx</span><span class="fu">::</span><span class="fu"><a href="../reference/computeBliss.html">computeBliss</a></span><span class="op">(</span><span class="va">viability_1</span>, <span class="va">viability_2</span><span class="op">)</span>,</span>
<span>        Loewe_ref<span class="op">=</span><span class="fu">PharmacoGx</span><span class="fu">::</span><span class="fu"><a href="../reference/computeLoewe.html">computeLoewe</a></span><span class="op">(</span></span>
<span>            <span class="va">treatment1dose</span>, HS_1<span class="op">=</span><span class="va">HS_1</span>, EC50_1<span class="op">=</span><span class="va">EC50_1</span>, E_inf_1<span class="op">=</span><span class="va">E_inf_1</span>,</span>
<span>            <span class="va">treatment2dose</span>, HS_2<span class="op">=</span><span class="va">HS_2</span>, EC50_2<span class="op">=</span><span class="va">EC50_2</span>, E_inf_2<span class="op">=</span><span class="va">E_inf_2</span></span>
<span>        <span class="op">)</span>,</span>
<span>        ZIP_ref<span class="op">=</span><span class="fu"><a href="../reference/computeZIP.html">computeZIP</a></span><span class="op">(</span></span>
<span>            <span class="va">treatment1dose</span>, HS_1<span class="op">=</span><span class="va">HS_1</span>, EC50_1<span class="op">=</span><span class="va">EC50_1</span>, E_inf_1<span class="op">=</span><span class="va">E_inf_1</span>,</span>
<span>            <span class="va">treatment2dose</span>, HS_2<span class="op">=</span><span class="va">HS_2</span>, EC50_2<span class="op">=</span><span class="va">EC50_2</span>, E_inf_2<span class="op">=</span><span class="va">E_inf_2</span></span>
<span>        <span class="op">)</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/assayKeys.html" class="external-link">assayKeys</a></span><span class="op">(</span><span class="va">tre_combo</span>, <span class="st">"combo_viability"</span><span class="op">)</span>,</span>
<span>        nthread<span class="op">=</span><span class="fl">2</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Once we have our null hypotheis for no drug synergy, computing a
synergy score is as simple as taking the difference or the ratio between
the observed drug combination viability and each of our reference
models. We prefer taking the difference, since the resulting value can
be interpreted as the proportion of cell death above or below the
expected value for each model.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre_synergy</span> <span class="op">&lt;-</span> <span class="va">tre_synergy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        assay<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        HSA_score<span class="op">=</span><span class="va">HSA_ref</span> <span class="op">-</span> <span class="va">mean_viability</span>,</span>
<span>        Bliss_score<span class="op">=</span><span class="va">Bliss_ref</span> <span class="op">-</span> <span class="va">mean_viability</span>,</span>
<span>        Loewe_score<span class="op">=</span><span class="va">Loewe_ref</span> <span class="op">-</span> <span class="va">mean_viability</span>,</span>
<span>        ZIP_score<span class="op">=</span><span class="va">ZIP_ref</span> <span class="op">-</span> <span class="va">mean_viability</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/assayKeys.html" class="external-link">assayKeys</a></span><span class="op">(</span><span class="va">tre_synergy</span>, <span class="st">"combo_viability"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>In addition to standard synergy scores, the ZIP model also provides a
more subtle metric of drug synergy that attempts to quantify shifts in
the relative potency and efficacy of drugs in a combination. This
metrics is referred to as ZIP delta, and is computed from a two-way
curve fit for the expected effect of adding drug 1 to drug 2 and drug 2
to drug 1 for a pair in combinaton. <span class="citation">(Yadav et al.
2015)</span>.</p>
<p>Below we demonstrate how to compute ZIP delta using <em><a href="https://bioconductor.org/packages/3.16/PharmacoGx" class="external-link">PharmacoGx</a></em>.
We first use the <code>estimateProjParams</code> method to compute the
dose-response curve parameters for the two-way curve fits.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre_zip</span> <span class="op">&lt;-</span> <span class="va">tre_synergy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        assay<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        subset<span class="op">=</span><span class="va">treatment2dose</span> <span class="op">!=</span> <span class="fl">0</span>,</span>
<span>        <span class="op">{</span></span>
<span>            <span class="va">zip_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateProjParams.html">estimateProjParams</a></span><span class="op">(</span></span>
<span>                dose_to<span class="op">=</span><span class="va">treatment1dose</span>,</span>
<span>                combo_viability<span class="op">=</span><span class="va">mean_viability</span>,</span>
<span>                dose_add<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">treatment2dose</span><span class="op">)</span>,</span>
<span>                EC50_add<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">EC50_2</span><span class="op">)</span>,</span>
<span>                HS_add<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">HS_2</span><span class="op">)</span>,</span>
<span>                E_inf_add<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">E_inf_2</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">zip_fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">zip_fit</span><span class="op">)</span>, <span class="st">"_2_to_1"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>        enlist<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"treatment2id"</span>, <span class="st">"treatment2dose"</span>, <span class="st">"sampleid"</span><span class="op">)</span>,</span>
<span>        nthread<span class="op">=</span><span class="fl">2</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">tre_zip</span> <span class="op">&lt;-</span> <span class="va">tre_zip</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        assay<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        subset<span class="op">=</span><span class="va">treatment1dose</span> <span class="op">!=</span> <span class="fl">0</span>,</span>
<span>        <span class="op">{</span></span>
<span>            <span class="va">zip_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateProjParams.html">estimateProjParams</a></span><span class="op">(</span></span>
<span>                dose_to<span class="op">=</span><span class="va">treatment2dose</span>,</span>
<span>                combo_viability<span class="op">=</span><span class="va">mean_viability</span>,</span>
<span>                dose_add<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">treatment1dose</span><span class="op">)</span>,</span>
<span>                EC50_add<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">EC50_1</span><span class="op">)</span>,</span>
<span>                HS_add<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">HS_1</span><span class="op">)</span>,</span>
<span>                E_inf_add<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">E_inf_1</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">zip_fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">zip_fit</span><span class="op">)</span>, <span class="st">"_1_to_2"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>        enlist<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment1id"</span>, <span class="st">"treatment2id"</span>, <span class="st">"treatment1dose"</span>, <span class="st">"sampleid"</span><span class="op">)</span>,</span>
<span>        nthread<span class="op">=</span><span class="fl">2</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Then we use the <code>.deltaScore</code> function to compute the
final delta score using the two-way fit curve parameters from the
previous step.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tre_zip</span> <span class="op">&lt;-</span> <span class="va">tre_zip</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>        assay<span class="op">=</span><span class="st">"combo_viability"</span>,</span>
<span>        ZIP_delta<span class="op">=</span><span class="fu">.deltaScore</span><span class="op">(</span></span>
<span>            EC50_1_to_2<span class="op">=</span><span class="va">EC50_proj_1_to_2</span>, EC50_2_to_1<span class="op">=</span><span class="va">EC50_proj_2_to_1</span>,</span>
<span>            EC50_1<span class="op">=</span><span class="va">EC50_1</span>, EC50_2<span class="op">=</span><span class="va">EC50_2</span>,</span>
<span>            HS_1_to_2<span class="op">=</span><span class="va">HS_proj_1_to_2</span>, HS_2_to_1<span class="op">=</span><span class="va">HS_proj_2_to_1</span>,</span>
<span>            HS_1<span class="op">=</span><span class="va">HS_1</span>, HS_2<span class="op">=</span><span class="va">HS_2</span>,</span>
<span>            E_inf_1_to_2<span class="op">=</span><span class="va">E_inf_proj_1_to_2</span>, E_inf_2_to_1<span class="op">=</span><span class="va">E_inf_proj_2_to_1</span>,</span>
<span>            E_inf_1<span class="op">=</span><span class="va">E_inf_1</span>, E_inf_2<span class="op">=</span><span class="va">E_inf_2</span>,</span>
<span>            treatment1dose<span class="op">=</span><span class="va">treatment1dose</span>, treatment2dose<span class="op">=</span><span class="va">treatment2dose</span>,</span>
<span>            ZIP<span class="op">=</span><span class="va">ZIP_ref</span></span>
<span>        <span class="op">)</span>,</span>
<span>        by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/assayKeys.html" class="external-link">assayKeys</a></span><span class="op">(</span><span class="va">tre_zip</span>, <span class="st">"combo_viability"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Now that we have computed synergy scores for all of our drug pairs,
we can visualize our results before moving on to downstream analyses
looking for biomarkers of synergy and antagonism.</p>
</div>
<div class="section level3">
<h3 id="visualizing-drug-synergy">Visualizing Drug Synergy<a class="anchor" aria-label="anchor" href="#visualizing-drug-synergy"></a>
</h3>
<p>Since the Loewe and ZIP synergy metrics require fitting dose-response
curves, it is possible that bad fits could yield misleading synergy
scores. Given this fact, we recommend applying a curve fit quality
filter before continuing with downstream analysis. Below we require
curves to obtain an R-squared greater than 0.5 (that is, &gt;50%
variance of the data explained by the fit) before ranking treatment
pairs by their synergy score. If you are ranking using HSA or Bliss,
such a filter is not required, as these two metrics use only the
observed monotherapy viabilities to calculate the expected
viability.</p>
<p>The following code filters to only high quality curve fits and then
finds the 15 most synergistic treatment pairs based on their ZIP delta
score.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combo_viab</span> <span class="op">&lt;-</span> <span class="va">tre_zip</span><span class="op">[[</span><span class="st">"combo_viability"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">(</span><span class="va">top_15_combo</span> <span class="op">&lt;-</span> <span class="va">combo_viab</span><span class="op">[</span></span>
<span>    <span class="va">Rsq_1</span> <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">&amp;</span> <span class="va">Rsqr_1_to_2</span> <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">&amp;</span> <span class="va">Rsqr_2_to_1</span> <span class="op">&gt;</span> <span class="fl">0.5</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/dot-.html" class="external-link">.</a></span><span class="op">(</span></span>
<span>        max_delta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ZIP_delta</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        mean_delta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ZIP_delta</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        max_bliss<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Bliss_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        mean_bliss<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Bliss_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/dot-.html" class="external-link">.</a></span><span class="op">(</span><span class="va">treatment1id</span>, <span class="va">treatment2id</span>, <span class="va">sampleid</span><span class="op">)</span></span>
<span><span class="op">]</span><span class="op">[</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html" class="external-link">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">max_delta</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.SD</span><span class="op">)</span></span>
<span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Before visualizing drug synergy, we recommend filling in any NA
synergy scores to avoid gaps in the produced plots. This can be easily
accomplished using the <code><a href="https://Rdatatable.gitlab.io/data.table/reference/nafill.html" class="external-link">data.table::setnafill</a></code> function with
the last observation carried forward strategy.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_15_combo_df</span> <span class="op">&lt;-</span> <span class="va">combo_viab</span><span class="op">[</span><span class="va">top_15_combo</span>, on<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'treatment1id'</span>, <span class="st">'treatment2id'</span>, <span class="st">'sampleid'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Last observation carried forward for NA/NaN delta scores, to make plot look nicer</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/nafill.html" class="external-link">setnafill</a></span><span class="op">(</span><span class="va">top_15_combo_df</span>, type<span class="op">=</span><span class="st">"locf"</span>, cols<span class="op">=</span><span class="st">"ZIP_delta"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>ggplot2</code> package can be used to visualize the synergy
scores for our top 15 most synergistic treatment pairs. Below we provide
example code to produce both a contour plot (synergy surface) as well as
a heat map to gain a more inuitive understanding of how synergy or
antagonism changes over the full dose range of each drug combination
matrix.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_15_combo_df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">treatment1dose</span>, y<span class="op">=</span><span class="va">treatment2dose</span>, z<span class="op">=</span><span class="va">ZIP_delta</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>oob<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/oob.html" class="external-link">squish_infinite</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span>oob<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/oob.html" class="external-link">squish_infinite</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour_filled</a></span><span class="op">(</span></span>
<span>        breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">treatment1id</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"RdBu"</span>, direction<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_15_combo_df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment1dose</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment2dose</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">ZIP_delta</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">treatment1id</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"blue"</span>, mid<span class="op">=</span><span class="st">"white"</span>, high<span class="op">=</span><span class="st">"red"</span>, midpoint<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>To learn how to use synergy scores for biomarker discovery please
review our workshop from Bioconductor 2022, linked in the first section
of this document.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] ggplot2_3.4.2               data.table_1.14.8          </span></span>
<span><span class="co">##  [3] PharmacoGx_3.3.4            CoreGx_2.2.0               </span></span>
<span><span class="co">##  [5] SummarizedExperiment_1.28.0 Biobase_2.58.0             </span></span>
<span><span class="co">##  [7] GenomicRanges_1.50.2        GenomeInfoDb_1.34.9        </span></span>
<span><span class="co">##  [9] IRanges_2.32.0              S4Vectors_0.36.2           </span></span>
<span><span class="co">## [11] MatrixGenerics_1.10.0       matrixStats_0.63.0         </span></span>
<span><span class="co">## [13] BiocGenerics_0.44.0         BiocStyle_2.26.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] fgsea_1.24.0                colorspace_2.1-0           </span></span>
<span><span class="co">##   [3] ellipsis_0.3.2              rprojroot_2.0.3            </span></span>
<span><span class="co">##   [5] lsa_0.73.3                  XVector_0.38.0             </span></span>
<span><span class="co">##   [7] fs_1.6.1                    SnowballC_0.7.0            </span></span>
<span><span class="co">##   [9] MultiAssayExperiment_1.24.0 DT_0.27                    </span></span>
<span><span class="co">##  [11] fansi_1.0.4                 R.methodsS3_1.8.2          </span></span>
<span><span class="co">##  [13] codetools_0.2-18            cachem_1.0.7               </span></span>
<span><span class="co">##  [15] knitr_1.42                  jsonlite_1.8.4             </span></span>
<span><span class="co">##  [17] magicaxis_2.2.14            cluster_2.1.3              </span></span>
<span><span class="co">##  [19] R.oo_1.25.0                 shinydashboard_0.7.2       </span></span>
<span><span class="co">##  [21] shiny_1.7.4                 mapproj_1.2.11             </span></span>
<span><span class="co">##  [23] BiocManager_1.30.20         compiler_4.2.1             </span></span>
<span><span class="co">##  [25] backports_1.4.1             Matrix_1.4-1               </span></span>
<span><span class="co">##  [27] fastmap_1.1.1               bench_1.1.2                </span></span>
<span><span class="co">##  [29] limma_3.54.2                cli_3.6.1                  </span></span>
<span><span class="co">##  [31] later_1.3.0                 visNetwork_2.1.2           </span></span>
<span><span class="co">##  [33] htmltools_0.5.5             tools_4.2.1                </span></span>
<span><span class="co">##  [35] igraph_1.4.2                gtable_0.3.3               </span></span>
<span><span class="co">##  [37] glue_1.6.2                  GenomeInfoDbData_1.2.9     </span></span>
<span><span class="co">##  [39] reshape2_1.4.4              RANN_2.6.1                 </span></span>
<span><span class="co">##  [41] dplyr_1.1.2                 maps_3.4.1                 </span></span>
<span><span class="co">##  [43] fastmatch_1.1-3             Rcpp_1.0.10                </span></span>
<span><span class="co">##  [45] slam_0.1-50                 jquerylib_0.1.4            </span></span>
<span><span class="co">##  [47] pkgdown_2.0.7               vctrs_0.6.2                </span></span>
<span><span class="co">##  [49] BumpyMatrix_1.6.0           xfun_0.39                  </span></span>
<span><span class="co">##  [51] stringr_1.5.0               mime_0.12                  </span></span>
<span><span class="co">##  [53] lifecycle_1.0.3             gtools_3.9.4               </span></span>
<span><span class="co">##  [55] MASS_7.3-57                 zlibbioc_1.44.0            </span></span>
<span><span class="co">##  [57] scales_1.2.1                ragg_1.2.5                 </span></span>
<span><span class="co">##  [59] promises_1.2.0.1            relations_0.6-13           </span></span>
<span><span class="co">##  [61] parallel_4.2.1              RColorBrewer_1.1-3         </span></span>
<span><span class="co">##  [63] sets_1.0-24                 yaml_2.3.7                 </span></span>
<span><span class="co">##  [65] memoise_2.0.1               downloader_0.4             </span></span>
<span><span class="co">##  [67] sass_0.4.5                  stringi_1.7.12             </span></span>
<span><span class="co">##  [69] NISTunits_1.0.1             desc_1.4.2                 </span></span>
<span><span class="co">##  [71] plotrix_3.8-2               checkmate_2.1.0            </span></span>
<span><span class="co">##  [73] caTools_1.18.2              boot_1.3-28                </span></span>
<span><span class="co">##  [75] BiocParallel_1.32.6         rlang_1.1.0                </span></span>
<span><span class="co">##  [77] pkgconfig_2.0.3             systemfonts_1.0.4          </span></span>
<span><span class="co">##  [79] bitops_1.0-7                pracma_2.4.2               </span></span>
<span><span class="co">##  [81] evaluate_0.20               lattice_0.20-45            </span></span>
<span><span class="co">##  [83] purrr_1.0.1                 htmlwidgets_1.6.2          </span></span>
<span><span class="co">##  [85] cowplot_1.1.1               tidyselect_1.2.0           </span></span>
<span><span class="co">##  [87] plyr_1.8.8                  magrittr_2.0.3             </span></span>
<span><span class="co">##  [89] bookdown_0.33               R6_2.5.1                   </span></span>
<span><span class="co">##  [91] gplots_3.1.3                generics_0.1.3             </span></span>
<span><span class="co">##  [93] sm_2.2-5.7.1                DelayedArray_0.24.0        </span></span>
<span><span class="co">##  [95] withr_2.5.0                 pillar_1.9.0               </span></span>
<span><span class="co">##  [97] RCurl_1.98-1.12             tibble_3.2.1               </span></span>
<span><span class="co">##  [99] crayon_1.5.2                KernSmooth_2.23-20         </span></span>
<span><span class="co">## [101] utf8_1.2.3                  rmarkdown_2.21             </span></span>
<span><span class="co">## [103] grid_4.2.1                  marray_1.76.0              </span></span>
<span><span class="co">## [105] piano_2.14.0                digest_0.6.31              </span></span>
<span><span class="co">## [107] xtable_1.8-4                httpuv_1.6.9               </span></span>
<span><span class="co">## [109] R.utils_2.12.2              textshaping_0.3.6          </span></span>
<span><span class="co">## [111] celestial_1.4.6             coop_0.6-3                 </span></span>
<span><span class="co">## [113] munsell_0.5.0               bslib_0.4.2                </span></span>
<span><span class="co">## [115] shinyjs_2.1.0</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-mathewsgrinerHighthroughputCombinatorialScreening2014" class="csl-entry">
Mathews Griner, Lesley A., Rajarshi Guha, Paul Shinn, Ryan M. Young,
Jonathan M. Keller, Dongbo Liu, Ian S. Goldlust, et al. 2014.
<span>“High-Throughput Combinatorial Screening Identifies Drugs That
Cooperate with Ibrutinib to Kill Activated <span class="nocase">B-cell</span>like Diffuse Large <span class="nocase">B-cell</span> Lymphoma Cells.”</span> <em>Proceedings of
the National Academy of Sciences</em> 111 (6): 2349–54. <a href="https://doi.org/10.1073/pnas.1311846111" class="external-link">https://doi.org/10.1073/pnas.1311846111</a>.
</div>
<div id="ref-vlotApplyingSynergyMetrics2019a" class="csl-entry">
Vlot, Anna H. C., Natália Aniceto, Michael P. Menden, Gudrun
Ulrich-Merzenich, and Andreas Bender. 2019. <span>“Applying Synergy
Metrics to Combination Screening Data: Agreements, Disagreements and
Pitfalls.”</span> <em>Drug Discovery Today</em> 24 (12): 2286–98. <a href="https://doi.org/10.1016/j.drudis.2019.09.002" class="external-link">https://doi.org/10.1016/j.drudis.2019.09.002</a>.
</div>
<div id="ref-yadavSearchingDrugSynergy2015" class="csl-entry">
Yadav, Bhagwan, Krister Wennerberg, Tero Aittokallio, and Jing Tang.
2015. <span>“Searching for <span>Drug Synergy</span> in <span>Complex
Dose</span> an <span>Interaction Potency Model</span>.”</span>
<em>Computational and Structural Biotechnology Journal</em> 13
(January): 504–13. <a href="https://doi.org/10.1016/j.csbj.2015.09.001" class="external-link">https://doi.org/10.1016/j.csbj.2015.09.001</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Petr Smirnov, Christopher Eeles, Zhaleh Safikhani, Mark Freeman, Feifei Li, Jermiah Joseph, Benjamin Haibe-Kains.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
