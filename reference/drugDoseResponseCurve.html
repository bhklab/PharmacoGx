<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a list of PharmacoSets, the function will plot the drug_response curve,
for a given drug/cell pair. The y axis of the plot is the viability percentage
and x axis is the log transformed concentrations. If more than one pSet is
provided, a light gray area would show the common concentration range between pSets.
User can ask for type of sensitivity measurment to be shown in the plot legend.
The user can also provide a list of their own concentrations and viability values,
as in the examples below, and it will be treated as experiments equivalent to values coming
from a pset. The names of the concentration list determine the legend labels."><title>Plot drug response curve of a given drug and a given cell for a list of pSets (objects of the PharmacoSet class). — drugDoseResponseCurve • PharmacoGx</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot drug response curve of a given drug and a given cell for a list of pSets (objects of the PharmacoSet class). — drugDoseResponseCurve"><meta property="og:description" content="Given a list of PharmacoSets, the function will plot the drug_response curve,
for a given drug/cell pair. The y axis of the plot is the viability percentage
and x axis is the log transformed concentrations. If more than one pSet is
provided, a light gray area would show the common concentration range between pSets.
User can ask for type of sensitivity measurment to be shown in the plot legend.
The user can also provide a list of their own concentrations and viability values,
as in the examples below, and it will be treated as experiments equivalent to values coming
from a pset. The names of the concentration list determine the legend labels."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PharmacoGx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.7.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PharmacoGx.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/CreatingPharmacoSet.html">PharmacoGx: An R Package for Analysis of Large Pharmacogenomic Datasets</a>
    <a class="dropdown-item" href="../articles/DetectingDrugSynergyAndAntagonism.html">Detecting Drug Synergy and Antagonism with PharmacoGx 3.0+</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bhklab/PharmacoGx/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot drug response curve of a given drug and a given cell for a list of pSets (objects of the PharmacoSet class).</h1>
      <small class="dont-index">Source: <a href="https://github.com/bhklab/PharmacoGx/blob/HEAD/R/drugDoseResponseCurve.R" class="external-link"><code>R/drugDoseResponseCurve.R</code></a></small>
      <div class="d-none name"><code>drugDoseResponseCurve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a list of PharmacoSets, the function will plot the drug_response curve,
for a given drug/cell pair. The y axis of the plot is the viability percentage
and x axis is the log transformed concentrations. If more than one pSet is
provided, a light gray area would show the common concentration range between pSets.
User can ask for type of sensitivity measurment to be shown in the plot legend.
The user can also provide a list of their own concentrations and viability values,
as in the examples below, and it will be treated as experiments equivalent to values coming
from a pset. The names of the concentration list determine the legend labels.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">drugDoseResponseCurve</span><span class="op">(</span></span>
<span>  <span class="va">drug</span>,</span>
<span>  <span class="va">cellline</span>,</span>
<span>  pSets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  concentrations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  viabilities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  conc_as_log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  viability_as_pct <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trunc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legends.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ic50_published"</span>, <span class="st">"gi50_published"</span>, <span class="st">"auc_published"</span>,</span>
<span>    <span class="st">"auc_recomputed"</span>, <span class="st">"ic50_recomputed"</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  <span class="va">xlim</span>,</span>
<span>  <span class="va">mycol</span>,</span>
<span>  <span class="va">title</span>,</span>
<span>  plot.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fitted"</span>, <span class="st">"Actual"</span>, <span class="st">"Both"</span><span class="op">)</span>,</span>
<span>  summarize.replicates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  cex.main <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  legend.loc <span class="op">=</span> <span class="st">"topright"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sample_col <span class="op">=</span> <span class="st">"sampleid"</span>,</span>
<span>  treatment_col <span class="op">=</span> <span class="st">"treatmentid"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>drug</dt>
<dd><p><code>character(1)</code> A drug name for which the drug response curve should be
plotted. If the plot is desirable for more than one pharmaco set, A unique drug id
should be provided.</p></dd>


<dt>cellline</dt>
<dd><p><code>character(1)</code> A cell line name for which the drug response curve should be
plotted. If the plot is desirable for more than one pharmaco set, A unique cell id
should be provided.</p></dd>


<dt>pSets</dt>
<dd><p><code>list</code> a list of PharmacoSet objects, for which the function
should plot the curves.</p></dd>


<dt>concentrations, viabilities</dt>
<dd><p><code>list</code> A list of concentrations and viabilities to plot, the function assumes that
<code>concentrations[[i]]</code> is plotted against <code>viabilities[[i]]</code>. The names of the concentration list are used to create the legend labels</p></dd>


<dt>conc_as_log</dt>
<dd><p><code>logical</code>, if true, assumes that log10-concentration data has been given rather than concentration data,
and that log10(ICn) should be returned instead of ICn. Applies only to the concentrations parameter.</p></dd>


<dt>viability_as_pct</dt>
<dd><p><code>logical</code>, if false, assumes that viability is given as a decimal rather
than a percentage, and that E_inf passed in as decimal. Applies only to the viabilities parameter.</p></dd>


<dt>trunc</dt>
<dd><p><code>logical(1)</code> Should the viability values be truncated to lie in [0-100] before doing the fitting</p></dd>


<dt>legends.label</dt>
<dd><p><code>numeric</code> A vector of sensitivity measurment types which could
be any combination of  ic50_published, auc_published, auc_recomputed and auc_recomputed_star.
A legend will be displayed on the top right of the plot which each line of the legend is
the values of requested sensitivity measerments for one of the requested pSets.
If this parameter is missed no legend would be provided for the plot.</p></dd>


<dt>ylim</dt>
<dd><p><code>numeric</code> A vector of two numerical values to be used as ylim of the plot.
If this parameter would be missed c(0,100) would be used as the ylim of the plot.</p></dd>


<dt>xlim</dt>
<dd><p><code>numeric</code> A vector of two numerical values to be used as xlim of the plot.
If this parameter would be missed the minimum and maximum comncentrations between all
the pSets would be used as plot xlim.</p></dd>


<dt>mycol</dt>
<dd><p><code>numeric</code> A vector with the same lenght of the pSets parameter which
will determine the color of the curve for the pharmaco sets. If this parameter is
missed default colors from Rcolorbrewer package will be used as curves color.</p></dd>


<dt>title</dt>
<dd><p><code>character</code> The title of the graph. If no title is provided, then it defaults to
'Drug':'Cell Line'.</p></dd>


<dt>plot.type</dt>
<dd><p><code>character</code> Plot type which can be the actual one ("Actual") or
the one fitted by logl logistic regression ("Fitted") or both of them ("Both").
If this parameter is missed by default actual curve is plotted.</p></dd>


<dt>summarize.replicates</dt>
<dd><p><code>character</code> If this parameter is set to true replicates
are summarized and replicates are plotted individually otherwise</p></dd>


<dt>lwd</dt>
<dd><p><code>numeric</code> The line width to plot with</p></dd>


<dt>cex</dt>
<dd><p><code>numeric</code> The cex parameter passed to plot</p></dd>


<dt>cex.main</dt>
<dd><p><code>numeric</code> The cex.main parameter passed to plot, controls the size of the titles</p></dd>


<dt>legend.loc</dt>
<dd><p>And argument passable to xy.coords for the position to place the legend.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical(1)</code> Should warning messages about the data passed in be printed?</p></dd>


<dt>sample_col</dt>
<dd><p><code>character(1)</code> The name of the column in the profiles assay that contains the sample IDs.</p></dd>


<dt>treatment_col</dt>
<dd><p><code>character(1)</code> The name of the column in the profiles assay that contains the treatment IDs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Plots to the active graphics device and returns an invisible NULL.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Manually enter the plot parameters</span></span></span>
<span class="r-in"><span><span class="fu">drugDoseResponseCurve</span><span class="op">(</span>concentrations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Experiment 1"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.008</span>, <span class="fl">.04</span>, <span class="fl">.2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> viabilities<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">50</span>,<span class="fl">30</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, plot.type<span class="op">=</span><span class="st">"Both"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a plot from one or more PSets</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">GDSCsmall</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">drugDoseResponseCurve</span><span class="op">(</span>drug<span class="op">=</span><span class="st">"Doxorubicin"</span>, cellline<span class="op">=</span><span class="st">"22RV1"</span>, pSets<span class="op">=</span><span class="va">GDSCsmall</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Petr Smirnov, Christopher Eeles, Jermiah Joseph, Zhaleh Safikhani, Mark Freeman, Feifei Li, Benjamin Haibe-Kains.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer></div>

  

  

  </body></html>

